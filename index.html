<!DOCTYPE html>
<html>
<head>
  <title>Surprise Potential</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

  <link rel="icon" href="./favicon.ico?">

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <meta property="og:image:width" content="1600" />
  <meta property="og:image:height" content="900" />

  <style>
    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
    }
    .button.is-active {
    background-color: #999999 !important; 
    color: white !important; 
    }
  </style>

</head>
<body>

  <!-- <section class="hero">
    <div class="hero-body no-bottom-padding mb-0">
      <div class="container">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Surprise Potential as a Measure of Interactivity <br>in Driving Scenarios</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a target="_blank" href="https://wenhao.pub/">Wenhao Ding</a><sup>1</sup>&nbsp;&nbsp;&nbsp;
                <a target="_blank" href="https://sushantveer.github.io/">Sushant Veer</a><sup>1</sup>&nbsp;&nbsp;&nbsp;
                <a target="_blank" href="https://faculty.washington.edu/kymleung/">Karen Leung</a><sup>1, 2</sup>&nbsp;&nbsp;&nbsp;
                <a target="_blank" href="https://kikacaty.github.io/">Yulong Cao</a><sup>1</sup>&nbsp;&nbsp;&nbsp;
                <a target="_blank" href="https://web.stanford.edu/~pavone/index.html">Marco Pavone</a><sup>1, 3</sup>&nbsp;&nbsp;&nbsp;
                <br/><sup>1</sup>NVIDIA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<sup>2</sup>University of Washington&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<sup>3</sup>Stanford University
              </span>
            </div>
            <div class="column has-text-centered">
              <div class="publication-links">
                <span class="link-block">
                  <a href="https://arxiv.org/pdf/2502.05677.pdf" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"><i class="fas fa-file-pdf"></i></span>
                    <span>Paper</span>
                  </a>
                </span>
                &nbsp;&nbsp;

                <span class="link-block">
                  <a target="_blank" href="https://arxiv.org/abs/2502.05677" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"> <i class="ai ai-arxiv"></i> </span>
                    <span>arXiv</span>
                  </a>
                </span>
                &nbsp;&nbsp;

                <span class="link-block">
                  <a href="#interactivity-score-section" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"> <i class="ai ai-coursera"></i> </span>
                    <span>Interactivity Score</span>
                  </a>
                </span>

                <span class="link-block">
                  <a target="_blank" href="" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
                    </span>
                    <span>Code (coming soon)</span>
                  </a>
                </span>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section> -->

  <!-- submit version -->
  <section class="hero">
    <div class="hero-body no-bottom-padding mb-0">
      <div class="container">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Surprise Potential as a Measure of Interactivity <br>in Driving Scenarios</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                Under Review
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <section class="section mt-0">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-three-quarters">
          <!-- <h4 class="title is-4" style="text-align: center; padding-bottom: 10px;"><bold>New Reset Distributions</bold></h4> -->
          <div class="column is-centered">
            <img src="./resources/website_teaser.png" width="100%" class="center">
          </div>

          <p style="text-align: left; font-size: 19px;">
            In this paper, we present a novel metric that identifies interactive scenarios by measuring an AV's surprise potential on others. 
            First, we identify three dimensions of the design space to describe a family of surprise potential measures. 
            Second, we exhaustively evaluate and compare different instantiations of the surprise potential measure within this design space on the nuScenes dataset. 
            To determine how well a surprise potential measure correctly identifies an interactive scenario, we use a reward model learned from human preferences to assess alignment with human intuition. 
            Our proposed surprise potential, arising from this exhaustive comparative study, achieves a correlation of more than 0.82 with the human-aligned reward function, outperforming existing approaches. 
          </p>

        </div> 
      </div>
    </div>
  </section>


  <section class="hero is-light is-small">
    <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-three-quarters">
          <h3 class="title is-3" style="text-align: center; padding-bottom: 1px; color: #76b900">Distribution of Surprise Potential of Different Datasets</h3>
        </div>
      </div>
    </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-quarters-quarters">
          <!-- <h4 class="title is-4" style="text-align: center; padding-bottom: 10px;"><bold>New Reset Distributions</bold></h4> -->
          <div class="columns is-centered">
            <div class="column is-centered">
                <p style="text-align: center; font-size: 25px">nuScenes training split</p>
                <img src="./resources/nuscene_train.jpg">
            </div>
            <div class="column is-centered">
                <p style="text-align: center; font-size: 25px">nuScenes validation split</p>
                <img src="./resources/nuscenes_val.jpg">
            </div>
          </div>

          <div class="content has-text-justified">
            <div class="rack-selector-nuscenes">
                <div class="buttons has-addons is-centered">
                    <button class="button is-light is-active is-size-6 is-rounded" onclick="changeRack([
                      './resources/nuscenes/val/0.0_1.gif', 
                      './resources/nuscenes/val/0.0_2.gif', 
                      './resources/nuscenes/val/0.0_3.gif', 
                    ], event, 'nuscenes')">Score ~ 0.0</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuscenes/val/0.2_1.gif', 
                      './resources/nuscenes/val/0.2_2.gif', 
                      './resources/nuscenes/val/0.2_3.gif', 
                    ], event, 'nuscenes')">Score ~ 0.2</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuscenes/val/0.4_1.gif', 
                      './resources/nuscenes/val/0.4_2.gif', 
                      './resources/nuscenes/val/0.4_3.gif', 
                    ], event, 'nuscenes')">Score ~ 0.4</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuscenes/val/0.6_1.gif', 
                      './resources/nuscenes/val/0.6_2.gif', 
                      './resources/nuscenes/val/0.6_3.gif', 
                    ], event, 'nuscenes')">Score ~ 0.6</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuscenes/val/0.8_1.gif', 
                      './resources/nuscenes/val/0.8_2.gif', 
                      './resources/nuscenes/val/0.8_3.gif', 
                    ], event, 'nuscenes')">Score ~ 0.8</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6 is-rounded" onclick="changeRack([
                      './resources/nuscenes/val/1.0_1.gif', 
                      './resources/nuscenes/val/1.0_2.gif', 
                      './resources/nuscenes/val/1.0_3.gif', 
                    ], event, 'nuscenes')">Score ~ 1.0</button>
                </div>
            </div>
            <div id="rack-video" class="video-container">
                <br>
                <div class="video-wrapper">
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="nuscenes-1" src='./resources/nuscenes/val/0.0_1.gif'>
                    </div>
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="nuscenes-2" src='./resources/nuscenes/val/0.0_2.gif'>
                    </div>
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="nuscenes-3" src='./resources/nuscenes/val/0.0_3.gif'>
                    </div>
                </div>
            </div>
          </div>

        </div> 
      </div>
    </div>
  </section>

  <hr class="rounded">

  <section class="section">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-quarters-quarters">
          <!-- <h4 class="title is-4" style="text-align: center; padding-bottom: 10px;"><bold>New Reset Distributions</bold></h4> -->
          <div class="columns is-centered">
            <div class="column is-centered">
                <p style="text-align: center; font-size: 25px">nuPlan-mini training split</p>
                <img src="./resources/nuplanmini_train.png">
            </div>
            <div class="column is-centered">
                <p style="text-align: center; font-size: 25px">nuPlan-mini validation split</p>
                <img src="./resources/nuplanmini_val.png">
            </div>
          </div>
          <div class="content has-text-justified">
            <div class="rack-selector-nuplanmini">
                <div class="buttons has-addons is-centered">
                    <button class="button is-light is-active is-size-6 is-rounded" onclick="changeRack([
                      './resources/nuplanmini/val/0.0_1.gif', 
                      './resources/nuplanmini/val/0.0_2.gif', 
                      './resources/nuplanmini/val/0.0_3.gif', 
                    ], event, 'nuplanmini')">Score ~ 0.0</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuplanmini/val/0.2_1.gif', 
                      './resources/nuplanmini/val/0.2_2.gif', 
                      './resources/nuplanmini/val/0.2_3.gif', 
                    ], event, 'nuplanmini')">Score ~ 0.2</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuplanmini/val/0.4_1.gif', 
                      './resources/nuplanmini/val/0.4_2.gif', 
                      './resources/nuplanmini/val/0.4_3.gif', 
                    ], event, 'nuplanmini')">Score ~ 0.4</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuplanmini/val/0.6_1.gif', 
                      './resources/nuplanmini/val/0.6_2.gif', 
                      './resources/nuplanmini/val/0.6_3.gif', 
                    ], event, 'nuplanmini')">Score ~ 0.6</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/nuplanmini/val/0.8_1.gif', 
                      './resources/nuplanmini/val/0.8_2.gif', 
                      './resources/nuplanmini/val/0.8_3.gif', 
                    ], event, 'nuplanmini')">Score ~ 0.8</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6 is-rounded" onclick="changeRack([
                      './resources/nuplanmini/val/1.0_1.gif', 
                      './resources/nuplanmini/val/1.0_2.gif', 
                      './resources/nuplanmini/val/1.0_3.gif', 
                    ], event, 'nuplanmini')">Score ~ 1.0</button>
                </div>
            </div>
            <div id="rack-video" class="video-container">
                <br>
                <div class="video-wrapper">
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="nuplanmini-1" src='./resources/nuplanmini/val/0.0_1.gif'>
                    </div>
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="nuplanmini-2" src='./resources/nuplanmini/val/0.0_2.gif'>
                    </div>
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="nuplanmini-3" src='./resources/nuplanmini/val/0.0_3.gif'>
                    </div>
                </div>
            </div>
          </div>

        </div> 
      </div>
    </div>
  </section>

  <hr class="rounded">

  <section class="section">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-quarters-quarters">
          <!-- <h4 class="title is-4" style="text-align: center; padding-bottom: 10px;"><bold>New Reset Distributions</bold></h4> -->
          <div class="columns is-centered">
            <div class="column is-centered">
                <p style="text-align: center; font-size: 25px">Waymo training split</p>
                <img src="./resources/waymo_train.png">
            </div>
            <div class="column is-centered">
                <p style="text-align: center; font-size: 25px">Waymo validation split</p>
                <img src="./resources/waymo_val.png">
            </div>
          </div>
          <div class="content has-text-justified">
            <div class="rack-selector-waymo">
                <div class="buttons has-addons is-centered">
                    <button class="button is-light is-active is-size-6 is-rounded" onclick="changeRack([
                      './resources/waymo/val/0.0_1.gif', 
                      './resources/waymo/val/0.0_2.gif', 
                      './resources/waymo/val/0.0_3.gif', 
                    ], event, 'waymo')">Score ~ 0.0</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/waymo/val/0.2_1.gif', 
                      './resources/waymo/val/0.2_2.gif', 
                      './resources/waymo/val/0.2_3.gif', 
                    ], event, 'waymo')">Score ~ 0.2</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/waymo/val/0.4_1.gif', 
                      './resources/waymo/val/0.4_2.gif', 
                      './resources/waymo/val/0.4_3.gif', 
                    ], event, 'waymo')">Score ~ 0.4</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/waymo/val/0.6_1.gif', 
                      './resources/waymo/val/0.6_2.gif', 
                      './resources/waymo/val/0.6_3.gif', 
                    ], event, 'waymo')">Score ~ 0.6</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6" onclick="changeRack([
                      './resources/waymo/val/0.8_1.gif', 
                      './resources/waymo/val/0.8_2.gif', 
                      './resources/waymo/val/0.8_3.gif', 
                    ], event, 'waymo')">Score ~ 0.8</button>
                    &nbsp;&nbsp;
                    <button class="button is-light is-size-6 is-rounded" onclick="changeRack([
                      './resources/waymo/val/1.0_1.gif', 
                      './resources/waymo/val/1.0_2.gif', 
                      './resources/waymo/val/1.0_3.gif', 
                    ], event, 'waymo')">Score ~ 1.0</button>
                </div>
            </div>
            <div id="rack-video" class="video-container">
                <br>
                <div class="video-wrapper">
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="waymo-1" src='./resources/waymo/val/0.0_1.gif'>
                    </div>
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="waymo-2" src='./resources/waymo/val/0.0_2.gif'>
                    </div>
                    <div style="width: 33%; float: left; text-align: center">
                        <img id="waymo-3" src='./resources/waymo/val/0.0_3.gif'>
                    </div>
                </div>
            </div>
          </div>

        </div> 
      </div>
    </div>
  </section>

  <section class="hero is-light is-small">
    <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-three-quarters">
          <h3 class="title is-3" style="text-align: center; padding-bottom: 1px; color: #76b900">Download Interactivity Score (To be updated)</h3>
        </div>
      </div>
    </div>
    </div>
  </section>

  <section id="interactivity-score-section" class="section">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-three-quarters">
          <div class="column is-centered">
            <p style="text-align: left; font-size: 20px;">
              You can download the interacivity score of the datasets used in the paper from the following links.
              Note that the score is for each segment of the dataset, which is obtained from the <a href="https://github.com/NVlabs/trajdata" target="_blank">trajdata</a> dataloader.
              Each segment has 5 second history and 4 second future with timestep interval of 0.5 second.
              Each file contains a dictionary with the following keys:
            </p>
            <ul style="font-size: 20px; text-align: left; list-style-type: disc; padding-left: 40px;">
              <li><code>idx</code>: The list of the name of the scene.</li>
              <li><code>ts</code>: The list of the start timestep of the future.</li>
              <li><code>data_idx</code>: The list of the index of the data sample in the trajdata dataloader.</li>
              <li><code>score</code>: The list of the (unnormalized) interactivity score of the segment.</li>
            </ul>
  
            <table class="table is-bordered is-fullwidth" style="margin: auto; text-align: center; font-size: 20px;">
              <thead>
                <tr>
                  <th>Dataset</th>
                  <th>Split</th>
                  <th>Segment number</th>
                  <th>Download Link</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>nuScenes</td>
                  <td>Train</td>
                  <td>15530</td>
                  <td>Google Drive</td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>nuScenes</td>
                  <td>Validation</td>
                  <td>3319</td>
                  <td>Google Drive</td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>Waymo</td>
                  <td>Train</td>
                  <td>487002</td>
                  <td>Google Drive</td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>Waymo</td>
                  <td>Validation</td>
                  <td>44097</td>
                  <td>Google Drive</td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>nuPlan mini</td>
                  <td>Train</td>
                  <td>19387</td>
                  <td>Google Drive</td>
                </tr>
              </tbody>
              <tbody>
                <tr>
                  <td>nuPlan mini</td>
                  <td>Validation</td>
                  <td>4074</td>
                  <td>Google Drive</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div> 
      </div>
    </div>
  </section>


  <hr class="rounded">

        </div> 
      </div>
    </div>
  </section>



  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre>
        <code>@article{ding2025surprise,
          title={Surprise Potential as a Measure of Interactivity in Driving Scenarios},
          author={Ding, Wenhao and Veer, Sushant and Leung, Karen and Cao, Yulong and Pavone, Marco},
          journal={arXiv preprint arXiv:2502.05677},
          year={2025}
        }</code>
      </pre>
    </div>
  </section>

  <section class="hero is-light is-small">
    <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
          <h6 style="text-align: center; padding-bottom: 1px; color: #000000">Template from <a href="https://nerfies.github.io">Nerfies</a></h3>
      </div>
    </div>
    </div>
  </section>

<script>
  function changeRack(videoSrcArray, event, rackName) {
      const videoPlayers = [
          document.getElementById(rackName+'-1'),
          document.getElementById(rackName+'-2'),
          document.getElementById(rackName+'-3')
      ];

      videoPlayers.forEach((player, index) => {
          if (player && videoSrcArray[index]) {
              player.src = videoSrcArray[index];
          }
      });

      // Remove active class from all buttons within the rack.
      document.querySelectorAll('.rack-selector-'+rackName+' .button').forEach(button => {
          button.classList.remove('is-active');
      });

      if (event && event.target) {
          event.target.classList.add('is-active');
      }
  }
</script>

</body>
</html>

